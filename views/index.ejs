<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mon Application</title>

  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.min.css">

</head>
<body>
      <h1>Carl-Hugo Poirier - Travail pratique 2</h1>
      <h2> Carnet d'adresse </h2>
  <!--button id='update'>Mise à jour téléphone</button>
    <form action="/adresse" method="POST">
    <input type="text" placeholder="nom" name="nom">
    <input type="text" placeholder="Telephone" name="telephone">
    <button type="submit">Submit</button>
  </form-->

  <table class="adresse">
     <tr>
          <th class='moyen'> Nom </th>
          <th class='moyen'> Prénom </th>
          <th class='moyen'> Téléphone </th>
          <th class='long'> _id </th>
          <th class='petit'> __ </th>
          <th id='ajouter' class='petit'><i class="fa fa-plus-circle" aria-hidden="true"></i></th>
    </tr>
    <tbody> 

        <% for(var i=0; i<adresses.length; i++) {%>
          <form class='modifier' action="/modifier" method="POST">
          <tr class="client">
             <td class='prenom' contenteditable="true"> <%= adresses[i].prenom %> </td>
             <td class='nom' contenteditable="true"> <%= adresses[i].nom %> </td>
             <td class='tel' contenteditable="true"> <%= adresses[i].tel %> </td>
             <td> <%= adresses[i]._id %> </td>
             <td> <i id="modifier" class="fa fa-floppy-o" aria-hidden="true"></i></td>
             <td> <a href="detruire/<%= adresses[i]._id %> %>"<i id="detruire" class="fa fa-trash" aria-hidden="true"></i> </a></td>
             <td><button type="submit">-</button>
       </tr>
       </form>
  <% } %>

    </tbody>
<script>

  //ajouter
  elmAjouter = document.getElementById('ajouter');
  elmAjouter.addEventListener('click', function() {
  console.log('ajouter')
  elmForm = document.createElement('form');
  elmTr = document.createElement('tr');

  //id, nom -1
    elmTd1 = document.createElement('td');                 
    elmTd1.setAttribute("contenteditable", "true" );   
    var att = document.createAttribute("id");
    elmTd1.setAttribute("id", "nom" );      

  //id, prenom -2
    elmTd2 = document.createElement('td');                 
    elmTd2.setAttribute("contenteditable", "true" );   
    var att = document.createAttribute("id");
    elmTd2.setAttribute("id", "prenom" );    

  //id, tel -3
    elmTd3 = document.createElement('td');                 
    elmTd3.setAttribute("contenteditable", "true" );   
    var att = document.createAttribute("id");
    elmTd3.setAttribute("id", "tel" );    

  //id, _id -4
    elmTd4 = document.createElement('td');                 
    elmTd4.setAttribute("contenteditable", "false" );   
    var att = document.createAttribute("id");
    elmTd4.setAttribute("id", "_id" );   

  //id, enr -5
    elmTd5 = document.createElement('td');    
    var att = document.createAttribute("id");
    elmTd5.setAttribute("id", "modifier" ); 
    var att = document.createAttribute("class");
    elmTd5.setAttribute("class", "fa fa-floppy-o" ); 
    var att = document.createAttribute("aria-hidden");
    elmTd5.setAttribute("aria-hidden", "true" );


  //id, del -6
    elmTd6 = document.createElement('td');    
    var att = document.createAttribute("id");
    elmTd6.setAttribute("id", "detruire" ); 
    var att = document.createAttribute("class");
    elmTd6.setAttribute("class", "fa fa-trash" ); 
    var att = document.createAttribute("aria-hidden");
    elmTd6.setAttribute("aria-hidden", "true" ); 


  elmTr.appendChild(elmTd1);
  elmTr.appendChild(elmTd2);
  elmTr.appendChild(elmTd3);
  elmTr.appendChild(elmTd4);
  elmTr.appendChild(elmTd5);
  elmTr.appendChild(elmTd6);
  elmForm.appendchild(elmTr);



  elmTbody = document.querySelector('.adresse tbody');
  elmPremierTr = document.querySelector('.client tr');

  elmTbody.insertBefore(elmTr, elmPremierTr);
  

})

  //Modifier
  

  elmModifier = document.querySelectorAll('.modifier');

  [].foreach.call(elmModifier, function(elm) {
       elmModifier.addEventListener('click', function() {
       var elmLigne = this.parentNode
    console.log('modifier');

  document.getElementById('nom').value = elmLigne.getElementsByClassName('nom')[0].innerHTML  
  document.getElementById('prenom').value = elmLigne.getElementsByClassName('prenom')[0].innerHTML
  document.getElementById('tel').value = elmLigne.getElementsByClassName('tel')[0].innerHTML


  })
 
 

  }

  
  //




})



</script>


</body>
</html>
</html>